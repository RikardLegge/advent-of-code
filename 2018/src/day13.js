function getRailAction(type) {
  switch (type) {
    case '-':
      return (cart) => {
        if (cart.dy) throw new Error("Wrong direction")
      };
    case '|':
      return (cart) => {
        if (cart.dx) throw new Error("Wrong direction")
      };
    case '+':
      return (cart) => {
        const a = -(1 - (cart.turns % 3)) * Math.PI / 2;
        const {dx, dy} = cart;
        cart.dx = Math.round(Math.cos(a) * dx - Math.sin(a) * dy);
        cart.dy = Math.round(Math.sin(a) * dx + Math.cos(a) * dy);
        cart.turns++;
      };
    case'/':
      return (cart) => {
        if (cart.dx) {
          cart.dy = -cart.dx;
          cart.dx = 0;
        } else {
          cart.dx = -cart.dy;
          cart.dy = 0;
        }
      };
    case'\\':
      return (cart) => {
        if (cart.dx) {
          cart.dy = cart.dx;
          cart.dx = 0;
        } else {
          cart.dx = cart.dy;
          cart.dy = 0;
        }
      };
    case' ':
      return () => {
        throw new Error("Cart derailed");
      }
  }
}

function newRail(type, cart = null) {
  const simulate = getRailAction(type);
  return {simulate, type, cart};
}

function newCart(x, y, dx, dy) {
  return {x, y, dx, dy, turns: 0}
}

function parse(input) {
  const rows = input.split('\n');
  const tracks = [];
  const carts = [];
  for (let y = 0; y < rows.length; y++) {
    const inputRow = rows[y];
    const trackRow = [];
    for (let x = 0; x < inputRow.length; x++) {
      const inputCell = inputRow[x];
      let cart = null;
      switch (inputCell) {
        case '>':
          cart = newCart(x, y, 1, 0);
          carts.push(cart);
          trackRow.push(newRail('-', cart));
          break;
        case '<':
          cart = newCart(x, y, -1, 0);
          carts.push(cart);
          trackRow.push(newRail('-', cart));
          break;
        case 'v':
          cart = newCart(x, y, 0, 1);
          carts.push(cart);
          trackRow.push(newRail('|', cart));
          break;
        case '^':
          cart = newCart(x, y, 0, -1);
          carts.push(cart);
          trackRow.push(newRail('|', cart));
          break;

        case '-':
          trackRow.push(newRail('-'));
          break;
        case '|':
          trackRow.push(newRail('|'));
          break;
        case '+':
          trackRow.push(newRail('+'));
          break;
        case '\\':
          trackRow.push(newRail('\\'));
          break;
        case '/':
          trackRow.push(newRail('/'));
          break;
        case ' ':
          trackRow.push(newRail(' '));
          break;
        default:
          throw new Error("Unknown track type: " + inputCell);
      }
    }
    tracks[y] = trackRow;
  }

  return {tracks, carts};
}

export function day13a() {
  const {tracks, carts} = parse(input);
  const width = tracks[0].length;

  for (let i = 0; i < 10000; i++) {
    carts.sort((a, b) => (a.x + a.y * width) - (b.x + b.y * width));

    for (const cart of carts) {
      const oldTrack = tracks[cart.y][cart.x];
      oldTrack.cart = null;
      cart.x += cart.dx;
      cart.y += cart.dy;

      const newTrack = tracks[cart.y][cart.x];
      if (newTrack.cart) return `${cart.x},${cart.y}`;

      newTrack.simulate(cart);
      newTrack.cart = cart;
    }
  }
}

export function day13b() {
  const {tracks, carts} = parse(input);
  const width = tracks[0].length;

  for (let i = 0; i < 10000000; i++) {
    carts.sort((a, b) => (a.x + a.y * width) - (b.x + b.y * width));

    const crashes = [];
    for (let i = 0; i < carts.length; i++) {
      const cart = carts[i];
      const oldTrack = tracks[cart.y][cart.x];
      // The cart has crashed
      if(!oldTrack.cart) continue;
      oldTrack.cart = null;
      cart.x += cart.dx;
      cart.y += cart.dy;

      const newTrack = tracks[cart.y][cart.x];
      if (newTrack.cart) {
        crashes.push([cart, newTrack.cart]);
        newTrack.cart = null;
        continue;
      }

      newTrack.simulate(cart);
      newTrack.cart = cart;
    }

    for (const [carta, cartb] of crashes) {
      const ia = carts.indexOf(carta);
      carts.splice(ia, 1);
      const ib = carts.indexOf(cartb);
      carts.splice(ib, 1);
    }

    if (carts.length === 1) {
      const cart = carts[0];
      return `${cart.x},${cart.y}`;
    }
  }
}

const testInput = `/>-<\\  
|   |  
| /<+-\\
| | | v
\\>+</ |
  |   ^
  \\<->/`;

const input = `                                   /--------------------------------------------------------------------------------------------\\                     
                                   |                    /-------------------------------\\                                       |                     
                                   |              /-----+-----------\\                   |                                       |                     
  /--------\\ /--------------------\\|              |     | /---------+--------------\\    |               /-----------------------+-----\\               
  |        | |        /-----------++--------------+-----+-+---------+----\\       /-+----+---------------+--------------\\        |     |               
  |        | |        |           ||              |     |/+---------+----+-------+-+----+---------------+--------------+--------+-----+-------------\\ 
/-+--------+-+--------+-----------++--------------+-----+++---------+----+-------+-+----+-----\\         |              |     /--+-----+-----\\       | 
| |     /--+-+--------+-----------++--------------+-----+++---------+----+-------+-+----+-----+---------+-----\\        |     |  |     |     |       | 
| | /---+<-+-+--------+-----------++--------------+-----+++---------+----+-------+-+----+-----+----\\    |     |        |     |  |     |  /--+------\\| 
| | |   |  | |        |/----------++------------<-+-----+++---------+----+------\\| |    |     |    |    |     |        |     |  |     |  |  |      || 
| | |   |  | |      /-++----------++--------------+-----+++---------+----+------++-+----+-----+----+----+-----+------\\ |     |  |     |  |  |      || 
| | |   |  | |      | ||    /-----++--------------+-----+++--\\      |    |      || |    |     |    |    |     |      | |     |  |     |  |  |      || 
| | |   |  | |      | ||    |     ||              |     |||  |      |    |      || |    |     |    |    |     |      | |     |  |     |  |  |      || 
| | |   |  ^ |      | ||    |     ||              |     |||  |      |    |      || |    |     |    |    |     |      | |     |  |     |  |  |      || 
| | |/--+--+-+------+-++----+\\    ||              |     |||  |      |    |      || |/---+-----+----+----+-----+------+-+-----+--+-----+-\\|  |      || 
| | ||  |  | |  /---+-++----++----++--------------+-----+++--+------+----+------++-++---+-----+----+----+-----+------+-+----\\|  |    /+-++--+------++\\
| | ||/-+--+-+--+---+-++----++----++-----\\        |     |||  |      |    |      || ||   |     |    |    |     |      | |    ||  |    || ||  |      |||
| | ||| |  | |  |   | ||/---++----++-----+--------+-----+++-\\|      | /--+------++-++-\\ |     |    |    |     |      | |    ||  |    || ||  |      |||
| | ||| |  | |  |   | |||   ||/---++-----+--------+-----+++-++------+-+--+------++-++-+-+-----+----+----+--\\  |      | |    ||  |    || ||  |      |||
| | ||| |  | |  |   \\-+++---+++---++-----+--------+-----+++-++------+-+--+------++-++-+-+-----+----+----+--+--+------/ |    ||  |    || ||  |      |||
| | ||| |  | |  |     |||   |||   ||     |  /-----+-----+++-++------+-+--+-----\\|| || | |     |    |    |  |  |        |    ||  |    || ||  |      |||
| | ||| |  | |  |     \\++---+++---++-----+--+-----+-----+++-++------+-+--/     ||| || | |    /+----+----+--+--+--------+----++--+----++-++--+\\     |||
| | |||/+--+-+--+------++---+++---++-----+--+-----+-----+++-++------+-+--------+++-++-+-+----++----+----+--+--+---\\    |    ||  |    || ||  ||     |||
| | |||||  | |  |      \\+---+++---++-----+--+-----+-----+++-++------+-+--------+/| || | |    ||    |    |  |  |   |    |    ||  |    || ||  ||     |||
| | |||||  | |  |       |/--+++---++-----+--+-----+-----+++-++------+-+--------+-+-++-+-+----++----+--\\ |  |  |   |    |    ||  |    || ||  ||     |||
| | ||||\\--+-+--+-------++--+++---++-----+--+-----+-----+++-++------+-+--------+-+-++-+-+----++----+--+-+--+--/   |    |    ||  |    || ||  ||     |||
| | ||||   | |  |       ||  |||   ||     |  |     |  /--+++-++------+\\|        | | || | |    ||    |  | |  |      |    |    ||  |    \\+-++--++-----++/
| | ||||   | |  |       ||  |||   ||     |  |     |  |  ||| ||      |||  /-----+-+-++-+-+----++----+--+-+--+------+----+----++--+-----+\\||  ||     || 
| |/++++---+-+-\\|       ||  |||   ||     |  |     |  |  ||| ||      |||  |     | | || | |    ||    |  | |  |      |    |    ||  |     ||||  ||     || 
| ||||\\+---+-+-++-------++--+++---++-----/  |     |  |  |||/++------+++--+-----+-+-++-+-+----++----+--+-+--+------+----+----++--+---\\ ||||  ||     || 
| |||| |   | | ||       ||  |||   ||        |     |  |  ||||||      ||| /+-----+-+-++-+-+----++----+--+-+--+------+---\\|    ||  |   | ||||  ||     || 
| |||| |   | | ||       ||  |||   ||        |     |  |  ||||||      ||| ||     | | || | |    ||    |  | |  |      |   ||    ||  |   | ||||  ||     || 
| |||| |   | | ||       ||  \\++---++--------+-----+--+--+++++/      ||| ||     | | || | |    ||    |  | |  |      |   ||    ||  |   | ||||  ||     || 
| |||| |   | | ||      /++---++---++--------+-----+--+--+++++-------+++-++-----+-+-++-+-+----++----+--+-+--+------+---++----++--+-\\ | ||||  ||     || 
| |||| |   | | ||      |||   ||   ||        |     |  |  |||||  /----+++-++-----+-+-++-+-+----++----+--+-+--+------+---++---\\||  | | | ||||  ||     || 
| |||| |   |/+-++------+++---++---++--------+-----+--+--+++++--+----+++-++-----+-+-++-+\\|    ||    |  | ^  |      |   ||   |||  | | | ||||  ||     || 
| |||| |   ||| ||      |||   ||   ||        |/----+--+--+++++--+----+++-++-----+-+-++-+++--\\ ||    |  | |  |      |   ||   |||  | | | ||||  ||     || 
| |||| |   ||| ||      |||   ||   ||        ||    |  |  |||||  |    ||| ||     | |/++-+++--+-++----+--+-+--+------+---++\\  |||  | | | ||||  ||     || 
| |||| |   ||| ||      |||   ||   ||        ||    |  | /+++++--+----+++-++-----+-++++-+++--+-++----+--+-+--+------+---+++--+++--+-+-+-++++--++---\\ || 
| |||| |   ||| ||      |||   ||   ||        ||    | /+-++++++--+----+++-++-----+-++++-+++--+-++-\\  |  | |  |      |   |||  |||  | | | ||||  ||   | || 
| |||| | /-+++-++--\\   |||   ||   ||    /---++----+-++-++++++--+----+++-++-----+-++++-+++--+-++-+--+--+-+--+--\\   |   |||  |||  | | | ||||  ||   | || 
| |||| | | ||| ||  |   |||   ||   ||/---+---++----+-++-++++++--+----+++-++-----+-++++-+++--+-++\\|  |  | \\--+--+---+---+++--+++--+-+-+-/|||  ||   | || 
| |||| | | ||| ||  |   |||   |\\---+++---+---++----+-++-++++++--+----+++-++-----+-++++-+++--+-++++--+--+----/  |   |   |||  |||  | | |/-+++--++-\\ | || 
| |||| | | ||| ||  |   |||   |    |||   |   ||   /+-++-++++++--+----+++-++-----+-++++-+++--+-++++--+--+------\\|   |   |||  |||  | | || |v|  || | | || 
| |||| | | ||| ||  |   |||   |    |||   |   ||   || || ||||||  |    ||| ||     | |||| |||  | ||||  |  |      ||   |   |||  |||  | | || |||  || | | || 
| |||| | | ||| || /+---+++---+---\\|||   |   ||   || || ||\\+++--+----+++-++-----+-++++-+++--+-++++--+--+------++---+---+++--+++--+-+-++-+++--++-+-+-+/ 
| |||| \\-+-+++-++-++---+++---+---++++---+---++---++-++-++-+++--+----+++-++-----+-++++-+++--+-++++--+--+------++---/   |||  |||  | | || ||\\--++-+-+-/  
| ||||   | ||| || ||   |||   |   ||||   |   ||   || || || |||  |    ||| ||/----+-++++-+++--+-++++--+--+------++-------+++--+++\\ | | || ||   || | |    
| ||||   | ||| || || /-+++---+---++++---+---++---++\\||/++-+++--+----+++-+++----+-++++-+++--+-++++--+-\\|      ||       |||  |||| | | || ||   || | |    
| ||||   | ||| || || | |||  /+---++++--\\|   ||   |||||||| |||  |    ||| |||    | |||| |||  | ||||  | ||      ||       |||  |||| | | || ||   || | |    
| ||||   | ||| || || | |||/-++---++++--++---++---++++++++-+++--+----+++-+++----+-++++\\|||  | ||||  | ||      ||       |||  |||| | | || ||   || | |    
| ||||   | ||| || || | |||| ||   |||| /++---++---++++++++-+++--+----+++-+++----+-++++++++--+-++++--+-++------++--\\    |||  |||| | | || ||   || | |    
| ||||   | ||| || || | ||||/++---++++-+++---++---++++++++-+++--+----+++-+++----+-++++++++--+-++++--+-++------++--+----+++--++++-+-+\\|| ||   || | |    
| ||||   | ||| || || | |||||||   |||| |||   ||   |||||||| |||  |    ||| |||/---+-++++++++--+-++++--+-++------++--+----+++--++++-+-++++\\||   || | |    
| ||||   | ||| || || | ||\\++++---++++-+++---++---++++++++-+++--+----+++-++++---+-++++++++--+-++++--+-+/      ||  |    |||  |||| | |||||||  /++-+-+--\\ 
| ||||   | ||| || || | || ||||   |||| ^||   ||   |||||||| |||  |    ||| ||||/--+-++++++++--+-++++--+-+-------++--+----+++--++++-+-+++++++--+++-+-+\\ | 
| ||||   | |\\+-++-++-+-++-++++---++++-+++---++---++++++++-+++--+----+++-+++++--+-++++++/|  | ||||  | |       ||  |    |||  |||| | |||||||  ||| | || | 
| ||||   | | | || || | || ||||   ||||/+++---++---++++++++-+++--+----+++-+++++--+-++++++-+--+-++++--+-+-------++--+----+++--++++-+-+++++++--+++\\| || | 
| ||||   | | | || || | || |||v   |||||||| /-++---++++++++-+++--+-\\  ||| |||||  | |||||| |  | ||||  | |  /-<--++--+----+++-\\|||| | |||||v|  ||||| || | 
| ||||   | | | || || | || ||||   |||||||| | ||   |||||||| ||| /+-+--+++-+++++--+-++++++-+\\ | ||||  | |  |    ||  |    ||| ||||| | |||||||  ||||| || | 
| ||||   | | | || || |/++-++++-\\ |||||||| | ||   |||||||| ||| || |  ||| |||||  | |||||| || | ||||  | |  |    ||  |    ||| ||||| | |||||||  ||||| || | 
|/++++---+-+-+-++-++-++++-++++-+-++++++++-+-++---++++++++-+++-++-+--+++-+++++\\ | |||||| || | ||||  | |  |    ||  |    ||| ||||| | |||||||  ||||| || | 
||||||   | | | || || |||| |||| | |||||||| | ||   |||||||| ||| ||/+--+++-++++++-+-++++++-++-+-++++--+\\|  |    ||  |    ||| ||||| | |||||||  ||||| || | 
||||||   | | | || || |||| |||| | |||||||| | ||   \\+++++++-+++-++++--+++-++++++-+-++++++-++-+-++++--+++--+----/|  |    ||| ||||| | |||||||  ||||| || | 
||||||   | | | || || |||| |||| | |||||||| | ||  /-+++++++-+++-++++--+++-++++++-+-++++++-++-+-++++--+++-\\|     |  |    ||| ||||| | |||||||  ||||| || | 
||||||  /+-+-+-++-++-++++-++++-+-++++++++-+-++--+-+++++++-+++-++++--+++-++++++-+-++++++-++-+-++++--+++-++-----+\\ |    ||| ||||| | |||||||  ||||| || | 
||||||  || | | || || |||| |||| | |||||||| v ||  | \\++++++-+++-++++--/|| ||\\+++-+-++++++-++-+-++++--+++-++-----++-+----+++-++++/ | |||\\+++--++++/ || | 
||||||  || | | || || |||| |||| | |||||||| | ||  |  |||||| ||| ||||   |\\-++-+++-+-+++++/ || | ||||  ||| ||     || |    ||| ||||  | ||| |||  ||||  || | 
||||||  || | | || || |||| |||| | |||||||| | ||  |  |||||| ||| |||| /-+--++-+++-+-+++++--++-+-++++--+++-++-\\   || |    ||| ||||  | ||| |||  ||||  || | 
||||||  || | | || || |||| |||| | |||||||| | ||  |  |\\++++-+++-++++-+-+--++-+++-+-+++++--++-+-+++/  ||| || |   || |    ||| ||||  | ||| |||  ||||  || | 
||||||  || | | || || |||| |||| | |||||||| | ||  |  | |||| ||| |||| | |  \\+-+++-+-+++++--++-+-+++---+++-++-+---++-+----/|| ||||  | |||/+++--++++\\ || | 
||||||  || | | || || |||| |||| | |||||||| | ||  |  | |||| ||| |||| | |   | ||| | |||||  || | |||   ||| || |   || |     || ||||  | |||||||  ||||| || | 
||||||  || | | || || |||| |||| |/++++++++-+-++--+--+-++++-+++-++++-+-+---+-+++-+-+++++--++-+-+++---+++-++-+---++-+-\\   || ||||  | |||||||  ||||| || | 
||||||  || | | || || ||\\+-++++-++++++++++-+-++--+--+-++++-+++-++++-+-+---+-+++-+-+++++--++-+-+++---+++-++-+---++-+-+---++-++++--+-/||||||  ||||| || | 
||||||  || | | || || || | |||| ||||||\\+++-+-++--+--+-++++-+++-++++-+-+---+-+++-+-+++++--++-+-+++---+++-++-+---++-+-+---++-++++--+--++++++--+++/| || | 
||||||  || | | || || || | |||| |||||| ||| | ||/-+--+-++++-+++-++++-+-+-\\ | ||| | |||||  || | |||   ||| || |   || | |   || ||||  |  ||||||  ||| | || | 
||||||  || | | || || || |/++++-++++++-+++-+<+++-+--+-++++-+++-++++-+-+-+-+-+++-+-+++++--++-+\\|||   ||| || |   || | |   || ||||  |  ||||||  ||| | || | 
||||||  || | | |\\-++-++-++++++-++++++-+++-+-+++-+--+-++++-+++-++++-+-+-+-+-+++-+-+++++--++-+++++---+++-++-+---++-+-+---++-++/|  |  ||||||  ||| | || | 
\\+++++--++-+-+-+--++-++-++++++-++++++-+++-+-+++-+--+-++++-+++-++++-+-+-+-+-+++-+-+++++--++-+++/|/--+++-++-+---++-+-+---++-++-+--+--++++++--+++\\| || | 
 ||||| /++-+-+-+--++-++-++++++-++++++-+++-+\\||| |  | |||| ||| |||| | | | |/+++-+-+++++\\ || ||| ||  ||| || | /-++-+-+---++-++-+--+--++++++--+++++-++\\| 
 ||||| ||| | | |  \\+-++-++++++-++/||| ||| ||||| |  | |||| ||| |||| | | | ||||| | |||||| || ||| ||  ||| || | | || | |   || || |  |  ||||||  ||||| |||| 
 ||||| ||| | | |   | || |||||| || ||| ||| \\++++-+--+-++++-+++-+++/ | | | ||||| | |||||| || ||| ||  ||| || | | || | |   || || \\--+--++++++--+/||| |||| 
 ||||| ||| | | |   | || ||||||/++-+++-+++--++++-+--+-++++-+++-+++--+-+-+-+++++-+-++++++-++-+++-++--+++-++-+-+-++-+-+\\  || ||    |  ||||||  | ||| |||| 
 ||||| ||| | | |   | || ||||||||| ||| |||  |||| |  | |||| ||| ||| /+-+-+-+++++-+-++++++-++-+++-++--+++-++-+-+-++-+-++--++-++----+--++++++--+-+++\\|||| 
 ||||| ||| | | |   | || ||||||||\\-+++-+++--++++-+--+-++++-+++-+++-++-+-+-+++++-+-++++++-++-+++-++--+++-++-+-+-++-+-/|  || ||    |  ||\\+++--+-++/||||| 
 ||||| ||| | | |   | || ||||||||/-+++-+++-\\|||| |  | |||| ||| ||\\-++-+-+-+++++-+-++++++-++-+++-++--+/| || | | || |  |  || ||    |  || |||  | || ||||| 
 ||||| ||| | | |   | |\\-+++++++/| |||/+++-+++++-+--+\\|||| ||| ||  || | | ||||| | |||||| || ||| ||  | | || | | || |  |  || ||    |  || |||  \\-++-++++/ 
 ||||| ||| | | |   | |  ||||||| | ||||||| ||||| |  |||||| ||| |\\--++-+-+-+++++-+-++++++-++-+++-++--+-+-++-+-+-++-+--+--++-+/    |  || |||    || ||||  
 ||||| ||| | | |   | |  ||||\\++-+-+++++/| ||||| |  |||||| ||| |   || | | ||||| |/++++++-++-+++-++--+-+-++-+-+-++-+--+-\\|| |     |  || |||    || ||||  
 ||||| ||| | | |   | |  |||| || | ||||| | ||||| |  |||||| ||| |   || | | ||||| ||\\+++++-++-+++-++--+-+-++-+-+-++-+--+-+/| |     |  || |||    || ||||  
 ||||| ||| | | |   | |  |||| || | ||||| | ||||| |  |||||| ||| |   || | | ||||| || ||||| || ||| ||  | | || | | || |  | | | |     |  || |||    || ||||  
 ||||| ||| | | |   | |  |||| || | ||||| | ||||| |  |||||| ||| |   || | | ||||| || ||||| || ||| |\\--+-+-++-+-+-++-+--+-+-+-+-----+--++-+++----+/ ||||  
 ||||| ||| | \\-+---+-+--++++-++-+-/\\+++-+-+++++-+--++++++-+++-+---++-+-+-+++++-++-+++++-++-+++-+---+-+-++-+-+-++-+--+-+-+-+-----/  || |||    |  ||||  
 ||||| ||| |   |   | |  |||| || |   ||| | ||||| |  |||\\++-+++-+---++-+-+-+++++-++-+++++-++-+++-+---+-/ || | | || |  | | | |        || |||    |  ||||  
 ||||| ||| | /-+---+-+--++++-++-+-\\ ||| | ||||| |  ||| \\+-+++-+---++-+-+-+++++-++-+++++-++-+++-+---+---++-+-+-++-+--+-+-+-+--------++-+++----+--+/||  
 ||||| ||| | | |   | |  |||| || | | ||| | ||||| |  |||  | ||| |   || | | |||||/++-+++++-++-+++-+---+---++-+-+-++-+--+-+-+-+-------\\|| |||    |  | ||  
 ||||| ||| | | |   | |  |||| || | | |||/+-+++++-+--+++--+-+++-+---++-+-+-++++++++-+++++\\|| ||| |   |   || | | || |  | | | |       ||| |||    |  | ||  
 ||||| ||| | | |   | |  |||| || | | ||||| ||||| |  |||  | ||| |   || | | |||||||| |||||||| ||| |/--+---++-+-+-++-+--+-+-+-+-------+++-+++----+-\\| ||  
 |||\\+-+++-+-+-+---+-+--++++-++-+-+-+++++-+++++-+--+++--+-+++-+---++-+-+-++++++++-++++++++-+++-++--/   || | | || |  | | | |       ||| |||    | || ||  
 ||| | ||| | | |   | |  |||| || | | ||||| ||||| |  |||  | ||| |   || | | |||||||| |||||||| ||| ||      || | | || |  | | | |       ||| |||    | || ||  
 ||| | ||| | | |   | |  |||| || | |/+++++-+++++-+--+++--+-+++-+---++-+-+>++++++++\\|||||||| ||| ||      || | | || |  | | | |       ||| |||    | || ||  
 ||| | ||| | | |   | |  |||| || | ||||||| ||||| |  |||  | ||| \\---++-+-+-++++++++++++++++/ ||| ||      || | | || |  | | | |       ||| |||    | || ||  
 ||| | ||| | | |   | |  |||| || | ||||||| ||||| |  |||  | |||     || | | ||||||||||||||||  ||| ||      || | | || |  | | | |       ||| |||    | || ||  
 ||| | ||| | | |   | |  |||| || | ||||||| ||||| |  |||  | |||     || | | ||||||||||||||||  ||\\-++------++-+-+-++-+--+-+-+-+-------+++-+++----/ || ||  
 ||| | ||| | \\-+---+-+--++++-++-+-/|||||| ||||| |  |||  | \\++-----++-+-+-++++++++++/|||||  ||  ||      || | | || |  | | | |/------+++-+++------++-++-\\
 \\++-+-+++-+---+---+-+--++++-++-+--++++++-+++++-+--+++--+--++-----++-+-+-++++/\\++++-+++++--++--++------++-+-+-++-+--+-+>+-++------/|| |||      || || |
  || | ||| |   |   | |  |||| || |  ||\\+++-+++++-+--+/|  |  ||     || | | ||||  |||| |||||  ||  |\\------++-+-+-++-+--+-+-+-++-------++-+++------/| || |
  || | ||| |   |   | |  |||| || \\--++-+++-/|\\++-+--+-+--+--++-----++-+-+-++++--/||| |||||  ||  |       || | | || |  | | | ||       || |||       | || |
  || \\-+++-+---+---+-+--++++-/|    || |||  | || |  | \\--+--++-----++-/ | ||||   ||| |||||  ||  |   /---++-+-+-++-+--+-+-+-++-------++-+++\\      | || |
/-++---+++-+---+---+-+--++++--+\\   || |||  | || |  |    \\--++-----++---+-++++---+++-++++/  ||  |   |   || | | || |  | | | ||       || ||||      | || |
| ||   ||| |   |   | |  ||||  ||   || ||\\--+-++-+--+-------++-----++---+-++++---+++-++++---++--+---+---++-+-+-/| |  | | | ||       || ||||      | || |
| \\+---+++-/   |   | |  ||||  ||   || ||   | || |  |       ||     ||   | \\+++---+++-++++---++--+---+---++-+-+--+-+--+-+-+-++-------++-+/||      | || |
|  |   |||     |   | |  ||||  ||   || ||   | || |  |       \\+-----++---+--+++---+++-++++---++--+---+---++-+-+--+-+--+-+-+-++-------+/ | ||      | || |
|  |   |||     |   | |  ||||  \\+---++-++---+-++-+--+--------+-----++---+--+++---+++-++++---++--+---+---++-+-+--+-+--/ | | ||       |  | ||      | || |
|  |   |||     |   | |  ||||   |   || ||   | \\+-+--+--------+-----++---+--+++---+++-++++---/|  |   |   || | |  | |    | | ||       |  | ||      | || |
|  |   |||     |   | |  \\+++---+---++-++---+--+-+--+--------/     ||   |  ||\\---+++-++++----+--+---+---++-+-+--+-+----+-+-++----->-+--+-++------+-/| |
|  |   |||     |   | \\---+++---+---++-++---+--+-+--/              |\\---+--++----+++-++++----+--+---+---++-/ |/-+-+----+-+-++-------+--+-++--\\   |  | |
|  |   |||     |   |     |||   |   || ||   |  | |                 |    |  ||    ||| \\+++----+--+---+---++---++-+-+----+-+-++-------+--+-/|  |   |  | |
|  |   |||     |   |     |||   |   || ||   |  | |                 |    |  ||    |||  |||    |  |   |   ||   \\+-+-+----+-+-++-------+--+--+--+---+--/ |
|  |   |||     |   |     |||   |   || ||   |  | |                 |    |  ||    |||  |||    |  |   |   ||    | | |    | | ||       |  |  |  |   |    |
|  |   |||     | /-+-----+++---+---++-++---+--+-+-----------------+----+--++----+++--+++---\\|  |   |   ||    | | |    | | ||       |  |  |  |   |    |
|  |   |\\+-----+-+-+-----+++---+---++-++---+--+-+-----------------+----+--++----+++--+++---++--+---+---++----+-//+----+-+-++-------+--+--+--+---+---\\|
|  |   | |     | | |     |||   |   || ||   |  | |                 \\----+--++----+++--+++---++--+---+---++----+--++----+-+-++-------+--+--+--+---/   ||
|  |/--+-+-----+-+-+-----+++---+---++-++---+--+-+----------------------+--++----+++--+++---++--+---+--<++----+\\ ||/---+-+-++-------+--+--+--+------\\||
|  ||  | |     | | |     |||   |   || |\\---+--+-+----------------------+--++----+++--++/   ||  |   |   ||    || |||   | | ||       |  |  |  |      |||
|  ||  | |     | | |     |||   |   || |    |  | |                      |  ||    \\++--++----++--+---+---++----++-+++---/ | ||       |  |  |  |      |||
|  ||  | |    /+-+-+-----+++---+---++-+----+--+-+-------------\\        |  ||     ||  ||    ||  |   |   |\\----++-+++-----+-/|       |  |  |  |      |||
|  ||  | |    || | |     |||   |   |\\-+----+--+-+-------------+--------+--++-----++--++----++--/   |   |     || |||     |  |       |  |  |  |      |||
|  \\+--+-+----+/ | |     |||   |   |  \\----+--+-+-------------+--------+--++-----++--++----++------+---+-----++-+/|     |  |       |  |  |  |      |||
|   |  | |    |  | |     |||   |   |       |  | |             |        |  ||     ||  ||    ||      |   |     || | |     |  |       |  |  |  |      |||
|   |  | |    |  | |     |||   |   \\-------+--+-+-------------+--------+--++-----/|  ||    ||      |   |     \\+-+-+-----+--+-------+--+--+--/      |||
|   |  | |    |  | |     |||   |           |  | |    /--------+--------+--++------+--++----++------+---+------+-+-+-----+--+--\\    |  |  |         |||
|   |  | |    |  | |     \\++---+-----------+--+-+----+--------+--------+--++------+--++----+/      |   |      | | |  /--+--+--+----+--+--+------\\  |||
\\---+--+-+----+--+-+------++---/           |  | |    |        |        |  ||      \\--++----+-------+---+------+-+-+--+--/  |  |    |  |  |      |  |||
    |  \\-+----+--+-+------++---------------/  | |    |        |    /---+--++---------++----+----\\  \\---+------+-+-+--+->---+--+----+--+--/      |  |||
    |    |    |  | |      |\\------------------+-+----+--------+----+---+--++---------++----+----+------+------+-+-+--+-----+--+----/  |         |  |||
    |    |    |  | |      |                   | \\----+--------+----+---+--++---------++----+----+------/      | | |  |     |  |       |         |  |||
    |    |    |  | |      |/------------------+------+--------+----+---+--++---------++----+----+------\\      | | |  |     |  |       |         |  |||
    |    |    |  | |      ||                  | /----+--------+----+---+--++---------++----+----+------+------+-+-+--+-----+--+-------+---------+\\ |||
    |    |    |  \\-+------++------------------+-+----+--------+----+---+--++---------++----/    |      |      |/+-+--+-----+--+-----\\ |         || |||
    |    |    \\----+------++------------------+-+----+--------/    |   |  \\+---------+/         |      |      ||\\-+--+-----+--+-----+-+---------++-+/|
    \\----+---------+------++------------------+-+----+-------------+---+---+---------+----------+------+------/|  \\--+-----+--+-----+-+---------++-/ |
         |         |      ||                  | |    |             |   |   \\---------+----------+------+-------+-----+-----+--+-----+-/         ||   |
         |         |      ||                  | |    |             \\---+-------------+----------/      |       |     \\-----+--+-----+-----------/|   |
         \\---------/      \\+------------------+-+----+-----------------+------------</                 |       |           |  |     |            |   |
                           |                  \\-+----+-----------------/                               |       |           |  |     |            |   |
                           |                    |    \\-------------------------------------------------+-------+-----------+--/     |            |   |
                           |                    |                                                      |       |           \\--------+------------+---/
                           |                    \\------------------------------------------------------+-------+--------------------+------------/    
                           \\---------------------------------------------------------------------------/       \\--------------------/`;
